<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>AI Quest - The Ultimate Challenge</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE and Edge */
    }

    *::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera */
    }
    
    :root {
      --gold: #FFD700;
      --gold-dark: #B8860B;
      --green: #10b981;
      --red: #ef4444;
      --bg-dark: #08080c;
      --bg-card: rgba(255,255,255,0.03);
      --border: rgba(255,255,255,0.08);
      --text: #ffffff;
      --text-dim: #6b7280;
    }
    
    html, body {
      height: 100%;
      overflow-x: hidden;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE and Edge */
    }

    html::-webkit-scrollbar,
    body::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera */
    }
    
    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: var(--bg-dark);
      color: var(--text);
      min-height: 100vh;
      -webkit-tap-highlight-color: transparent;
    }
    
    /* Layout */
    .screen { 
      display: none; 
      min-height: 100vh; 
      padding: 40px; 
      position: relative;
      z-index: 1;
      overflow-y: auto;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE and Edge */
    }

    .screen::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera */
    }

    .screen.active { 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
    }
    
    /* Cards */
    .glass-card {
      background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
      border: 1px solid var(--border);
      border-radius: 20px;
      backdrop-filter: blur(10px);
    }
    
    /* Buttons */
    .btn {
      padding: 12px 24px;
      font-family: inherit;
      font-size: 0.9rem;
      font-weight: 600;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      transform: scale(1);
    }

    .btn:active {
      transform: scale(0.95);
      transition: transform 0.1s ease;
    }
    
    .btn-gold {
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
      color: #000;
      box-shadow: 0 4px 25px rgba(255,215,0,0.3), inset 0 1px 0 rgba(255,255,255,0.3);
    }
    
    .btn-gold:hover, .btn-gold:active {
      transform: translateY(-2px);
      box-shadow: 0 6px 30px rgba(255,215,0,0.4), inset 0 1px 0 rgba(255,255,255,0.3);
    }
    
    .btn-gold::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s;
    }
    
    .btn-gold:hover::after {
      transform: translateX(100%);
    }
    
    .btn-secondary {
      background: rgba(255,255,255,0.06);
      color: var(--text);
      border: 1px solid var(--border);
    }
    
    .btn-secondary:hover, .btn-secondary:active {
      background: rgba(255,255,255,0.1);
      border-color: rgba(255,215,0,0.3);
    }

    /* ===== INTRO ===== */
    .intro-content { text-align: center; padding-top: 80px; }
    
    .logo-container {
      position: relative;
      width: 160px;
      height: 160px;
      margin: 0 auto 40px;
    }
    
    .logo-ring {
      position: absolute;
      inset: 0;
      border: 2px solid rgba(168,85,247,0.4);
      border-radius: 50%;
      animation: ringPulse 3s ease-in-out infinite;
    }
    
    .logo-ring:nth-child(2) {
      inset: -15px;
      border-color: rgba(6,182,212,0.3);
      animation-delay: -1s;
    }
    
    .logo-ring:nth-child(3) {
      inset: -30px;
      border-color: rgba(168,85,247,0.2);
      animation-delay: -2s;
    }
    
    @keyframes ringPulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.5; }
    }
    
    .logo-icon {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 70px;
      filter: drop-shadow(0 0 30px rgba(255,100,150,0.6)) 
              drop-shadow(0 0 60px rgba(255,100,150,0.4));
    }
    
    .title {
      font-size: clamp(3rem, 8vw, 5rem);
      font-weight: 900;
      letter-spacing: -0.03em;
      margin-bottom: 12px;
    }
    
    .title-ai {
      background: linear-gradient(135deg, #fff 0%, #888 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .title-quest {
      background: linear-gradient(135deg, var(--gold) 0%, #FFA500 50%, var(--gold-dark) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 2px 10px rgba(255,215,0,0.3));
    }

    .intro-teams {
      margin: 30px 0;
    }

    .intro-teams-label {
      font-size: 0.8rem;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 0.2em;
      margin-bottom: 12px;
    }

    .intro-teams-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      max-width: 700px;
      margin: 0 auto;
    }

    .intro-team-chip {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 14px;
      border-radius: 100px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      font-size: 0.85rem;
      font-weight: 600;
    }

    .intro-team-chip .team-icon {
      font-size: 1.1rem;
    }
    
    .tagline {
      color: var(--text-dim);
      font-size: 1rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      margin-bottom: 50px;
    }
    
    .stats-row {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-bottom: 50px;
    }
    
    .stat-card {
      padding: 24px 36px;
      text-align: center;
    }
    
    .stat-value {
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--gold) 0%, #FFA500 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .stat-label {
      font-size: 0.8rem;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-top: 4px;
    }

    /* ===== GAME LAYOUT WITH SIDE PANEL ===== */
    .game-layout {
      display: flex;
      width: 100%;
      max-width: 1500px;
      gap: 16px;
      margin-top: 15px;
    }

    /* ===== SIDE PANEL ===== */
    .side-panel {
      width: 180px;
      flex-shrink: 0;
      position: sticky;
      top: 15px;
      max-height: calc(100vh - 60px);
      overflow-y: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .side-panel::-webkit-scrollbar {
      display: none;
    }

    .side-panel-header {
      padding: 8px 10px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 4px;
    }

    .side-panel-title {
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--gold);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .questions-grid {
      padding: 6px;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 4px;
    }

    .q-tile {
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
      background: rgba(255,255,255,0.03);
      border: 1px solid transparent;
      padding: 2px;
      position: relative;
      font-size: 0.75rem;
    }

    .q-tile:hover {
      background: rgba(255,255,255,0.08);
      border-color: rgba(255,215,0,0.3);
      transform: scale(1.05);
    }

    .q-tile:active {
      transform: scale(0.95) !important;
      transition: transform 0.1s ease;
    }

    .q-tile.active {
      background: rgba(255,215,0,0.15);
      border-color: var(--gold);
    }

    .q-tile.answered {
      background: rgba(16,185,129,0.15);
      border-color: rgba(16,185,129,0.5);
    }

    .q-tile.skipped {
      background: rgba(255,255,255,0.05);
      border-color: rgba(255,255,255,0.15);
    }

    .q-tile-num {
      font-weight: 700;
      font-size: 0.85rem;
      color: var(--text-dim);
      line-height: 1;
    }

    .q-tile.active .q-tile-num {
      color: var(--gold);
    }

    .q-tile.answered .q-tile-num {
      color: var(--green);
    }

    .q-tile-team {
      font-size: 0.5rem;
      font-weight: 600;
      margin-top: 2px;
      color: var(--text-dim);
      max-width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .q-tile-pts {
      font-weight: 700;
      margin-left: 2px;
    }

    .q-tile-pts.correct {
      color: #4ade80;
    }

    .q-tile-pts.wrong {
      color: #f87171;
    }

    .panel-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      padding: 6px 8px;
      border-top: 1px solid var(--border);
      margin-top: 2px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 3px;
      font-size: 0.55rem;
      color: var(--text-dim);
    }

    .legend-dot {
      width: 6px;
      height: 6px;
      border-radius: 2px;
    }

    .legend-dot.current {
      background: var(--gold);
    }

    .legend-dot.answered {
      background: var(--green);
    }

    .legend-dot.unanswered {
      background: rgba(255,255,255,0.2);
    }

    /* Main Content */
    .main-content {
      flex: 1;
      min-width: 0;
    }

    /* ===== QUESTION ===== */
    .q-header {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 30px;
    }

    .q-header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      gap: 16px;
      padding: 4px 0;
    }
    
    .q-progress { 
      width: 100%;
    }
    
    .q-count {
      font-size: 1.1rem;
      display: flex;
      align-items: baseline;
      gap: 6px;
    }
    
    .q-count .current {
      font-size: 1.8rem;
      font-weight: 800;
      color: var(--gold);
    }
    
    .q-count .total {
      color: var(--text-dim);
    }
    
    .progress-track {
      height: 8px;
      background: rgba(255,255,255,0.1);
      border-radius: 100px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--gold) 0%, #FFA500 100%);
      border-radius: 100px;
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 0 20px rgba(255,215,0,0.5);
    }

    .header-buttons {
      display: flex;
      gap: 10px;
      padding: 4px;
      margin: -4px;
    }
    
    .category-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 22px;
      background: linear-gradient(135deg, rgba(255,215,0,0.15) 0%, rgba(255,215,0,0.05) 100%);
      border: 1px solid rgba(255,215,0,0.25);
      border-radius: 100px;
      color: var(--gold);
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 16px;
    }
    
    .question-card {
      width: 100%;
      padding: 50px 40px 35px 40px;
      text-align: center;
      position: relative;
      margin-bottom: 20px;
      margin-top: 20px;
    }

    .question-card.compact {
      padding: 45px 35px 30px 35px;
      margin-bottom: 16px;
    }
    
    .q-number {
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 28px;
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
      border-radius: 100px;
      font-size: 1.2rem;
      font-weight: 800;
      color: #000;
      box-shadow: 0 4px 20px rgba(255,215,0,0.3);
      z-index: 10;
    }
    
    .question-text {
      font-size: clamp(1.2rem, 2.5vw, 1.6rem);
      font-weight: 600;
      line-height: 1.5;
      margin-top: 5px;
      flex: 1;
      text-align: center;
    }

    /* Team Selection Display */
    .team-selection-display {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 80px 40px;
      text-align: center;
      min-height: 450px;
    }

    .selection-avatar {
      font-size: 8rem;
      margin-bottom: 40px;
      animation: floatBounce 3s ease-in-out infinite;
      filter: drop-shadow(0 15px 40px rgba(0,0,0,0.5));
    }

    .selection-avatar img {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid var(--gold);
    }

    @keyframes floatBounce {
      0%, 100% { transform: translateY(0) scale(1); }
      50% { transform: translateY(-20px) scale(1.05); }
    }

    .selection-label {
      font-size: 1rem;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 0.35em;
      margin-bottom: 12px;
      font-weight: 600;
    }

    .selection-team-name {
      font-size: 4rem;
      font-weight: 800;
      color: var(--gold);
      margin-bottom: 35px;
      text-shadow: 0 4px 30px rgba(255,215,0,0.4);
    }

    .selection-instruction {
      font-size: 1.15rem;
      color: var(--text-dim);
      max-width: 450px;
      line-height: 1.7;
    }

    .question-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }

    /* Question Row with Expand Trigger */
    .question-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      width: 100%;
    }

    .expand-trigger {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 44px;
      height: 44px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      flex-shrink: 0;
    }

    .expand-trigger:hover {
      background: rgba(255,215,0,0.1);
      border-color: var(--gold);
    }

    .expand-trigger:hover .expand-chevron {
      color: var(--gold);
    }

    .expand-chevron {
      width: 24px;
      height: 24px;
      color: var(--text-dim);
      transition: transform 0.3s ease, opacity 0.3s ease, color 0.2s ease;
    }

    .expand-chevron.expanded {
      transform: translateY(3px);
      opacity: 0.7;
      color: var(--gold);
    }

    /* Options Container with Animation */
    .options-container {
      width: 100%;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.35s ease-out, opacity 0.25s ease-out;
      opacity: 0;
      padding: 0;
    }

    .options-container.show {
      max-height: 500px;
      opacity: 1;
      padding-top: 16px;
      transition: max-height 0.4s ease-out, opacity 0.3s ease-in, padding 0.2s ease;
    }

    /* Tiebreaker Screen */
    .tiebreaker-content {
      text-align: center;
      padding: 40px 20px;
      max-width: 1000px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    .tie-icon {
      font-size: 5rem;
      margin-bottom: 20px;
      animation: shake 0.5s ease-in-out infinite alternate;
    }

    @keyframes shake {
      0% { transform: rotate(-5deg); }
      100% { transform: rotate(5deg); }
    }

    .tie-title {
      font-size: 3rem;
      font-weight: 800;
      color: var(--gold);
      margin-bottom: 10px;
      text-shadow: 0 4px 20px rgba(255,215,0,0.3);
    }

    .tie-subtitle {
      font-size: 1.1rem;
      color: var(--text-dim);
      margin-bottom: 40px;
    }

    .tiebreaker-grid {
      justify-content: center;
      max-width: 800px;
    }
    
    .options-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      width: 100%;
      margin-bottom: 20px;
    }
    
    .option-card {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 18px;
      transition: all 0.3s;
    }
    
    .option-card:hover, .option-card:active {
      border-color: rgba(255,215,0,0.3);
      transform: translateX(5px);
    }
    
    .option-letter {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
      border-radius: 10px;
      font-weight: 700;
      font-size: 0.9rem;
      color: #000;
      flex-shrink: 0;
      box-shadow: 0 2px 10px rgba(255,215,0,0.2);
    }
    
    .option-text {
      font-size: 0.95rem;
      font-weight: 500;
    }
    
    .actions-row {
      display: flex;
      gap: 10px;
      margin-bottom: 14px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .nav-row {
      display: flex;
      gap: 10px;
      margin-bottom: 14px;
      justify-content: center;
    }

    .btn-sm {
      padding: 10px 18px;
      font-size: 0.85rem;
    }

    .scoring-info.compact {
      padding: 12px 20px;
      font-size: 0.8rem;
    }

    /* ===== TEAMS PANEL (VERTICAL RIGHT SIDE) ===== */
    .teams-panel {
      width: 200px;
      flex-shrink: 0;
      position: sticky;
      top: 15px;
      max-height: calc(100vh - 60px);
      overflow-y: auto;
      scrollbar-width: none;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px;
    }

    .teams-panel::-webkit-scrollbar {
      display: none;
    }

    .teams-panel-title {
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--gold);
      margin-bottom: 14px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border);
    }

    .teams-strip {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .team-chip {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 12px 14px;
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      border: 1px solid transparent;
      transition: all 0.2s ease;
    }

    .team-chip.leading {
      background: rgba(255,215,0,0.1);
      border-color: rgba(255,215,0,0.3);
    }

    .team-chip-rank {
      font-size: 0.8rem;
      color: var(--text-dim);
      min-width: 18px;
    }

    .team-chip-name {
      flex: 1;
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text);
    }

    .team-chip.leading .team-chip-name {
      color: var(--gold);
    }

    .team-chip-score {
      font-size: 1rem;
      font-weight: 700;
      color: var(--gold);
      min-width: 24px;
      text-align: right;
    }

    /* Transition animation for question change */
    .main-content {
      transition: opacity 0.3s ease, transform 0.3s ease;
      overflow-y: auto;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE and Edge */
    }

    .main-content::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera */
    }

    .main-content.transitioning {
      opacity: 0;
      transform: translateX(30px);
    }

    .main-content.transitioning-in {
      opacity: 0;
      transform: translateX(-30px);
    }

    .btn-skip {
      background: rgba(255,255,255,0.06);
      color: var(--text-dim);
      border: 1px solid var(--border);
      padding: 14px 24px;
    }

    .btn-skip:hover {
      background: rgba(255,255,255,0.1);
      color: var(--text);
    }
    
    .scoring-info {
      display: flex;
      gap: 40px;
      padding: 16px 28px;
      font-size: 0.9rem;
      color: var(--text-dim);
      width: 100%;
      justify-content: center;
    }

    /* Navigation Row */
    .nav-row {
      display: flex;
      gap: 16px;
      justify-content: center;
      margin-bottom: 24px;
    }

    .nav-row .btn {
      min-width: 160px;
    }
    
    .scoring-info strong {
      color: var(--gold);
      font-weight: 700;
    }

    /* Question Answered Info on Question Page */
    .question-answered-info {
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 16px 28px;
      background: linear-gradient(135deg, rgba(16,185,129,0.1) 0%, rgba(16,185,129,0.03) 100%);
      border: 1px solid rgba(16,185,129,0.3);
      border-radius: 14px;
      margin-bottom: 24px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .qa-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 1rem;
    }

    .qa-item:not(:last-child)::after {
      content: '|';
      margin-left: 14px;
      color: rgba(255,255,255,0.2);
    }

    .qa-label {
      color: var(--text-dim);
      font-weight: 500;
    }

    .qa-value {
      font-weight: 700;
      color: var(--green);
    }

    .qa-value.negative {
      color: var(--red);
    }

    /* ===== REVEAL + AWARD ===== */
    .reveal-content {
      width: 100%;
      max-width: 1100px;
      padding-top: 30px;
    }
    
    .answer-showcase {
      display: flex;
      align-items: center;
      gap: 40px;
      padding: 25px;
      margin-bottom: 30px;
      background: linear-gradient(135deg, rgba(16,185,129,0.08) 0%, rgba(16,185,129,0.02) 100%);
      border: 1px solid rgba(16,185,129,0.2);
    }
    
    .answer-image {
      width: 200px;
      height: 200px;
      border-radius: 20px;
      overflow: hidden;
      flex-shrink: 0;
      border: 3px solid rgba(16,185,129,0.3);
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(139,92,246,0.2));
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .answer-image .fallback-icon {
      font-size: 5rem;
      opacity: 0.8;
    }
    
    .answer-details { flex: 1; }
    
    .answer-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 18px;
      background: rgba(16,185,129,0.2);
      border: 1px solid rgba(16,185,129,0.3);
      border-radius: 100px;
      color: var(--green);
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 16px;
    }
    
    .answer-badge::before {
      content: '‚úì';
      display: flex;
      align-items: center;
      justify-content: center;
      width: 20px;
      height: 20px;
      background: var(--green);
      border-radius: 50%;
      color: white;
      font-size: 0.7rem;
    }
    
    .answer-title {
      font-size: 2rem;
      font-weight: 700;
      color: var(--gold);
      margin-bottom: 12px;
    }
    
    .answer-desc {
      font-size: 1rem;
      color: #9ca3af;
      line-height: 1.7;
      text-align: left;
    }
    
    .assign-section {
      text-align: center;
    }
    
    .assign-title {
      font-size: 1.4rem;
      font-weight: 600;
      margin-bottom: 8px;
      color: #e5e7eb;
    }
    
    .assign-subtitle {
      font-size: 0.95rem;
      color: var(--text-dim);
      margin-bottom: 30px;
    }
    
    /* Desktop Teams Grid with Hover */
    .teams-grid {
      display: flex;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
      margin-bottom: 24px;
      padding: 20px 10px;
    }

    .teams-grid.no-hover .team-hover {
      display: none !important;
      pointer-events: none !important;
    }
    
    .team-card {
      position: relative;
      width: 130px;
      padding: 24px 16px;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
      border: 1px solid var(--border);
      transform: scale(1);
      z-index: 1;
    }
    
    .team-card:hover {
      transform: translateY(-8px) scale(1.03);
      border-color: var(--gold);
      box-shadow: 
        0 15px 40px rgba(255,215,0,0.2),
        0 0 0 1px rgba(255,215,0,0.3),
        inset 0 1px 0 rgba(255,255,255,0.1);
      z-index: 10;
    }
    
    .team-card.selected {
      border-color: var(--gold);
      box-shadow: 0 0 30px rgba(255,215,0,0.4);
      transform: scale(1.03);
      z-index: 10;
    }
    
    .team-icon {
      font-size: 2.8rem;
      margin-bottom: 10px;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
      transition: transform 0.3s;
    }
    
    .team-card:hover .team-icon {
      transform: scale(1.15);
    }
    
    .team-name {
      font-size: 1rem;
      font-weight: 700;
      margin-bottom: 4px;
      transition: color 0.3s;
    }
    
    .team-card:hover .team-name, .team-card.selected .team-name {
      color: var(--gold);
    }
    
    .team-score {
      font-size: 0.85rem;
      color: var(--text-dim);
    }
    
    /* Desktop Hover Overlay */
    .team-hover {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(0,0,0,0.95) 0%, rgba(20,20,30,0.95) 100%);
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease;
      z-index: 5;
    }
    
    .team-card:hover .team-hover {
      opacity: 1;
      pointer-events: auto;
      z-index: 20;
    }
    
    .hover-team-name {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--gold);
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .hover-team-image {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      object-fit: cover;
    }
    
    .hover-btn {
      width: 100%;
      padding: 12px 10px;
      border: none;
      border-radius: 10px;
      font-family: inherit;
      font-size: 0.9rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.15s ease;
      transform: scale(1);
      position: relative;
      z-index: 25;
      pointer-events: auto;
    }
    
    .hover-btn:hover {
      transform: scale(1.05);
      filter: brightness(1.1);
    }

    .hover-btn:active {
      transform: scale(0.95) !important;
      transition: transform 0.1s ease;
    }
    
    .hover-btn.correct {
      background: linear-gradient(135deg, var(--green) 0%, #059669 100%);
      color: white;
    }
    
    .hover-btn.wrong {
      background: linear-gradient(135deg, var(--red) 0%, #dc2626 100%);
      color: white;
    }

    /* Team Image Support */
    .team-image {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 10px;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
      transition: transform 0.3s;
    }

    .team-card:hover .team-image {
      transform: scale(1.15);
    }
    
    /* Mobile Action Panel */
    .mobile-action-panel {
      display: none;
      margin-top: 16px;
      padding: 20px;
      border-radius: 20px;
      background: linear-gradient(135deg, rgba(255,215,0,0.1) 0%, rgba(255,215,0,0.03) 100%);
      border: 1px solid rgba(255,215,0,0.2);
    }
    
    .selected-team-info {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 16px;
    }
    
    .selected-team-icon { font-size: 2rem; }
    .selected-team-img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
    .selected-team-name { font-size: 1.2rem; font-weight: 700; color: var(--gold); }
    
    .action-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    
    .action-btn {
      padding: 20px 16px;
      border: none;
      border-radius: 16px;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      transform: scale(1);
    }
    
    .action-btn .pts {
      font-size: 1.8rem;
      font-weight: 800;
    }
    
    .action-btn .label {
      font-size: 0.9rem;
      font-weight: 600;
      opacity: 0.9;
    }
    
    .action-btn.correct {
      background: linear-gradient(135deg, var(--green) 0%, #059669 100%);
      color: white;
      box-shadow: 0 8px 30px rgba(16,185,129,0.3);
    }
    
    .action-btn.wrong {
      background: linear-gradient(135deg, var(--red) 0%, #dc2626 100%);
      color: white;
      box-shadow: 0 8px 30px rgba(239,68,68,0.3);
    }
    
    .action-btn:hover {
      transform: translateY(-3px) scale(1.02);
    }

    .action-btn:active {
      transform: scale(0.95) !important;
      transition: transform 0.1s ease;
    }

    /* Already Answered Display */
    .already-answered {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 30px 40px;
      background: linear-gradient(135deg, rgba(255,215,0,0.1) 0%, rgba(255,215,0,0.03) 100%);
      border: 2px solid rgba(255,215,0,0.3);
      border-radius: 20px;
      margin: 20px auto;
      max-width: 400px;
    }

    .answered-label {
      font-size: 0.85rem;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 16px;
    }

    .answered-team {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .answered-team-icon {
      font-size: 3rem;
    }

    .answered-team-image {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      object-fit: cover;
    }

    .answered-team-name {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--gold);
    }

    .answered-result {
      padding: 8px 16px;
      border-radius: 100px;
      font-weight: 700;
      font-size: 0.9rem;
    }

    .answered-result.correct {
      background: rgba(16,185,129,0.2);
      color: var(--green);
      border: 1px solid rgba(16,185,129,0.3);
    }

    .answered-result.wrong {
      background: rgba(239,68,68,0.2);
      color: var(--red);
      border: 1px solid rgba(239,68,68,0.3);
    }
    
    .nav-btns {
      display: flex;
      gap: 12px;
      margin-top: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    /* ===== MODAL ===== */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
    
    .modal-overlay.show {
      opacity: 1;
      pointer-events: auto;
    }
    
    .modal {
      padding: 32px;
      border-radius: 24px;
      max-width: 400px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE and Edge */
    }

    .modal::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera */
    }
    
    .modal-title {
      font-size: 1.4rem;
      font-weight: 700;
      text-align: center;
      margin-bottom: 24px;
      color: var(--gold);
    }
    
    .modal-teams {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 24px;
    }
    
    .modal-team {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 18px;
      border-radius: 14px;
      background: rgba(255,255,255,0.03);
      border: 1px solid var(--border);
    }
    
    .modal-team.top {
      background: linear-gradient(135deg, rgba(255,215,0,0.15) 0%, rgba(255,215,0,0.05) 100%);
      border-color: rgba(255,215,0,0.3);
    }
    
    .modal-rank { font-size: 1.3rem; width: 32px; }
    .modal-icon { font-size: 1.5rem; }
    .modal-name { flex: 1; font-weight: 600; }
    .modal-pts { color: var(--gold); font-weight: 700; font-size: 1.1rem; }

    /* ===== TOAST ===== */
    .toast {
      position: fixed;
      top: 30px;
      left: 50%;
      transform: translateX(-50%) translateY(-200px);
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 18px 32px;
      border-radius: 100px;
      background: linear-gradient(135deg, rgba(0,0,0,0.9) 0%, rgba(20,20,30,0.95) 100%);
      border: 1px solid var(--border);
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      z-index: 2000;
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s ease;
      opacity: 0;
      visibility: hidden;
    }
    
    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
      visibility: visible;
    }
    
    .toast-icon { font-size: 2.5rem; }
    .toast-text { font-size: 1.1rem; font-weight: 600; }
    .toast-pts { font-size: 1.5rem; font-weight: 800; }
    .toast-pts.pos { color: var(--green); }
    .toast-pts.neg { color: var(--red); }
    .toast-pts.zero { color: var(--text-dim); }

    /* ===== CONFETTI ===== */
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 999;
      overflow: hidden;
    }
    
    .confetti {
      position: absolute;
      top: -20px;
      opacity: 0;
      animation: confettiFall 4s ease-out forwards;
    }
    
    .confetti.active {
      opacity: 1;
    }
    
    @keyframes confettiFall {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    /* ===== WINNER ===== */
    .winner-content {
      text-align: center;
      padding: 15px 20px;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    
    .trophy-container {
      position: relative;
      margin-bottom: 8px;
    }
    
    .trophy-glow {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 120px;
      height: 120px;
      background: radial-gradient(circle, rgba(255,215,0,0.4) 0%, transparent 70%);
      transform: translate(-50%, -50%);
      animation: trophyGlow 2s ease-in-out infinite;
    }
    
    @keyframes trophyGlow {
      0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.4; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.6; }
    }
    
    .trophy-icon {
      font-size: 4rem;
      position: relative;
      filter: drop-shadow(0 0 30px rgba(255,215,0,0.5));
      animation: trophyBounce 1.5s ease-in-out infinite;
    }
    
    @keyframes trophyBounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }
    
    .winner-label {
      font-size: 0.75rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: var(--text-dim);
      margin-bottom: 2px;
    }
    
    .champion-title {
      font-size: clamp(1.8rem, 4vw, 2.5rem);
      font-weight: 900;
      background: linear-gradient(135deg, var(--gold) 0%, #FFA500 50%, var(--gold-dark) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 15px;
      letter-spacing: 0.05em;
    }
    
    .winner-showcase {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      padding: 50px 80px;
      border-radius: 28px;
      box-shadow: 0 25px 80px rgba(0,0,0,0.5);
      min-width: 280px;
    }
    
    .winner-icon { font-size: 6rem; margin-bottom: 16px; }
    .winner-image { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; margin-bottom: 16px; }
    .winner-name { font-size: 2.8rem; font-weight: 800; color: #000; }
    .winner-score { font-size: 1.4rem; color: rgba(0,0,0,0.6); margin-top: 6px; }
    
    .winner-layout {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 80px;
      margin-bottom: 30px;
      width: 100%;
      max-width: 1100px;
    }
    
    .leaderboard-side {
      text-align: left;
      flex-shrink: 0;
    }
    
    .final-title {
      font-size: 1rem;
      color: #9ca3af;
      margin-bottom: 14px;
    }
    
    .final-leaderboard {
      display: flex;
      flex-direction: column;
      gap: 8px;
      min-width: 280px;
      max-width: 320px;
    }
    
    .final-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 18px;
      border-radius: 10px;
      background: rgba(255,255,255,0.03);
      border: 1px solid var(--border);
    }
    
    .final-row.gold {
      background: linear-gradient(135deg, rgba(255,215,0,0.15) 0%, rgba(255,215,0,0.05) 100%);
      border-color: rgba(255,215,0,0.3);
    }
    .final-row.silver {
      background: linear-gradient(135deg, rgba(192,192,192,0.08) 0%, rgba(192,192,192,0.02) 100%);
      border-color: rgba(192,192,192,0.2);
    }
    .final-row.bronze {
      background: linear-gradient(135deg, rgba(205,127,50,0.08) 0%, rgba(205,127,50,0.02) 100%);
      border-color: rgba(205,127,50,0.2);
    }
    
    .final-rank { font-size: 1rem; min-width: 28px; }
    .final-icon { display: none; }
    .final-image { display: none; }
    .final-name { flex: 1; font-weight: 600; font-size: 1rem; text-align: left; }
    .final-score { color: var(--gold); font-weight: 700; font-size: 1rem; }

    /* Mobile toggle for side panel */
    .panel-toggle {
      display: none;
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--gold);
      border: none;
      color: #000;
      font-size: 1.5rem;
      cursor: pointer;
      z-index: 100;
      box-shadow: 0 4px 20px rgba(255,215,0,0.4);
    }

    /* ===== MOBILE RESPONSIVE ===== */
    @media (max-width: 1024px) {
      .game-layout {
        flex-direction: column;
      }

      .side-panel {
        position: fixed;
        top: 0;
        left: -100%;
        width: 200px;
        height: 100vh;
        max-height: 100vh;
        z-index: 200;
        background: var(--bg-dark);
        border-right: 1px solid var(--border);
        transition: left 0.3s ease;
      }

      .side-panel.show {
        left: 0;
      }

      .teams-panel {
        display: none;
      }

      .panel-overlay {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.5);
        z-index: 150;
      }

      .panel-overlay.show {
        display: block;
      }

      .panel-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .main-content {
        width: 100%;
      }
    }

    @media (max-width: 768px) {
      .screen { padding: 20px; }
      
      /* Hide desktop hover overlay on mobile */
      .team-hover { display: none !important; }
      
      /* Show mobile action panel */
      .mobile-action-panel { display: none; }
      .mobile-action-panel.show { display: block; }
      
      /* Intro */
      .intro-content { padding-top: 40px; }
      .logo-container { width: 120px; height: 120px; margin-bottom: 30px; }
      .logo-icon { font-size: 50px; }
      .logo-ring:nth-child(2) { inset: -10px; }
      .logo-ring:nth-child(3) { inset: -20px; }
      .title { font-size: 2.5rem; }
      .tagline { font-size: 0.7rem; letter-spacing: 0.2em; margin-bottom: 30px; }
      .stats-row { flex-direction: row; gap: 10px; flex-wrap: wrap; justify-content: center; }
      .stat-card { padding: 16px 20px; min-width: 90px; }
      .stat-value { font-size: 1.8rem; }
      .stat-label { font-size: 0.7rem; }
      
      /* Question */
      .q-header { gap: 10px; margin-bottom: 20px; }
      .q-header-top { flex-wrap: wrap; gap: 10px; }
      .q-count .current { font-size: 1.4rem; }
      .header-buttons { gap: 6px; }
      .header-buttons .btn { padding: 8px 12px; font-size: 0.75rem; }
      .category-badge { padding: 8px 16px; font-size: 0.8rem; }
      .question-card { padding: 45px 20px 25px 20px; margin-bottom: 20px; margin-top: 15px; }
      .q-number { padding: 8px 20px; font-size: 1rem; top: -15px; }
      .question-text { font-size: 1.2rem; }
      
      /* Team Selection Mobile */
      .team-selection-display { padding: 50px 20px; min-height: 350px; }
      .selection-avatar { font-size: 5rem; margin-bottom: 25px; }
      .selection-avatar img { width: 100px; height: 100px; }
      .selection-label { font-size: 0.85rem; }
      .selection-team-name { font-size: 2.8rem; margin-bottom: 25px; }
      .selection-instruction { font-size: 1rem; }
      
      /* Options Toggle Mobile */
      .expand-trigger { width: 38px; height: 38px; }
      .expand-chevron { width: 20px; height: 20px; }
      
      /* Tiebreaker Mobile */
      .tiebreaker-content { padding: 30px 15px; }
      .tie-icon { font-size: 3.5rem; }
      .tie-title { font-size: 2rem; }
      .tie-subtitle { font-size: 0.95rem; margin-bottom: 30px; }
      .tiebreaker-grid { max-width: 100%; }
      
      .options-grid { grid-template-columns: 1fr; gap: 10px; margin-bottom: 20px; }
      .option-card { padding: 14px 16px; gap: 12px; }
      .option-letter { width: 36px; height: 36px; font-size: 0.9rem; }
      .option-text { font-size: 0.95rem; }
      .actions-row { flex-direction: column; gap: 12px; width: 100%; max-width: 400px; }
      .actions-row .btn { width: 100%; }
      .nav-row { flex-direction: row; gap: 10px; width: 100%; max-width: 400px; }
      .nav-row .btn { flex: 1; padding: 12px 16px; font-size: 0.85rem; }
      .nav-row { flex-direction: row; gap: 10px; width: 100%; max-width: 400px; }
      .nav-row .btn { min-width: auto; flex: 1; padding: 14px 16px; font-size: 0.9rem; }
      .scoring-info { flex-direction: column; gap: 8px; text-align: center; padding: 14px 20px; font-size: 0.8rem; }
      
      /* Question answered info mobile */
      .question-answered-info {
        flex-direction: column;
        gap: 12px;
        text-align: center;
        padding: 14px 20px;
      }
      
      .qa-item { font-size: 0.85rem; }
      .qa-label { font-size: 0.85rem; }
      .qa-value { font-size: 0.85rem; }
      
      /* Reveal */
      .reveal-content { padding-top: 15px; }
      .answer-showcase { flex-direction: column; text-align: center; padding: 20px; gap: 16px; margin-bottom: 20px; }
      .answer-image { width: 100px; height: 100px; }
      .answer-image .fallback-icon { font-size: 3rem; }
      .answer-title { font-size: 1.3rem; }
      .answer-desc { font-size: 0.85rem; }
      .answer-badge { padding: 6px 14px; font-size: 0.75rem; margin-bottom: 10px; }
      .assign-title { font-size: 1rem; }
      .assign-subtitle { font-size: 0.75rem; margin-bottom: 12px; }
      
      /* Mobile team grid - simple selection */
      .teams-grid { 
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
        width: 100%;
        margin-bottom: 16px;
      }
      .team-card { 
        width: 100%; 
        padding: 10px 6px; 
        border-radius: 12px;
      }
      .team-icon { font-size: 1.6rem; margin-bottom: 2px; }
      .team-name { font-size: 0.65rem; }
      .team-score { font-size: 0.6rem; }
      
      /* Modal */
      .modal { padding: 24px; border-radius: 20px; }
      .modal-title { font-size: 1.2rem; margin-bottom: 16px; }
      .modal-team { padding: 12px 14px; gap: 10px; }
      .modal-rank { font-size: 1.1rem; width: 28px; }
      .modal-icon { font-size: 1.2rem; }
      .modal-name { font-size: 0.9rem; }
      .modal-pts { font-size: 1rem; }
      
      /* Toast */
      .toast { padding: 14px 24px; gap: 12px; top: 20px; }
      .toast-icon { font-size: 2rem; }
      .toast-text { font-size: 1rem; }
      .toast-pts { font-size: 1.3rem; }
      
      /* Winner */
      .winner-content { padding-top: 30px; }
      .trophy-icon { font-size: 5rem; }
      .trophy-glow { width: 150px; height: 150px; }
      .winner-label { font-size: 0.85rem; }
      .champion-title { font-size: 2.5rem; margin-bottom: 30px; }
      .winner-layout { gap: 150px; }
      .winner-showcase { padding: 60px 100px; }
      .winner-icon { font-size: 7rem; margin-bottom: 20px; }
      .winner-image { width: 140px; height: 140px; }
      .winner-name { font-size: 3.2rem; }
      .winner-score { font-size: 1.5rem; }
      .final-title { font-size: 1.1rem; margin-bottom: 16px; }
    }

    @media (max-width: 900px) {
      .winner-layout { gap: 50px; }
      .winner-showcase { padding: 40px 60px; }
      .winner-icon { font-size: 5rem; }
      .winner-name { font-size: 2.2rem; }
      .final-leaderboard { min-width: 220px; }
    }

    @media (max-width: 600px) {
      .winner-layout {
        flex-direction: column;
        gap: 30px;
      }
      .leaderboard-side {
        text-align: center;
      }
      .final-leaderboard {
        align-items: center;
      }
      .winner-showcase {
        padding: 40px 60px;
      }
      .winner-icon { font-size: 5rem; }
      .winner-name { font-size: 2rem; }
      .winner-score { font-size: 1.1rem; }
    }
    
    @media (max-width: 400px) {
      .teams-grid { grid-template-columns: repeat(3, 1fr); gap: 6px; }
      .team-card { padding: 8px 4px; }
      .team-icon { font-size: 1.4rem; }
      .stats-row { gap: 8px; }
      .stat-card { padding: 14px 16px; min-width: 80px; }
    }
  </style>
</head>
<body>
  <!-- Confetti Container -->
  <div class="confetti-container" id="confettiContainer"></div>

  <!-- Toast -->
  <div class="toast" id="toast">
    <span class="toast-icon" id="toastIcon"></span>
    <span class="toast-text" id="toastText"></span>
    <span class="toast-pts" id="toastPts"></span>
  </div>

  <!-- Modal -->
  <div class="modal-overlay" id="modalOverlay" onclick="closeModal()">
    <div class="modal glass-card" onclick="event.stopPropagation()">
      <h2 class="modal-title">üìä Current Standings</h2>
      <div class="modal-teams" id="modalTeams"></div>
      <button class="btn btn-gold" style="width:100%" onclick="closeModal()">Close</button>
    </div>
  </div>

  <!-- Panel Overlay for mobile -->
  <div class="panel-overlay" id="panelOverlay" onclick="togglePanel()"></div>

  <!-- INTRO -->
  <div id="intro" class="screen active">
    <div class="intro-content">
      <div class="logo-container">
        <div class="logo-ring"></div>
        <div class="logo-ring"></div>
        <div class="logo-ring"></div>
        <div class="logo-icon">üß†</div>
      </div>
      <h1 class="title">
        <span class="title-ai">AI</span>
        <span class="title-quest">QUEST</span>
      </h1>
      <button class="btn btn-gold" onclick="startGame()">Begin Challenge ‚Üí</button>
    </div>
  </div>

  <!-- QUESTION -->
  <div id="question" class="screen">
    <div class="game-layout">
      <!-- Side Panel - Questions -->
      <div class="side-panel glass-card" id="sidePanel">
        <div class="side-panel-header">
          <div class="side-panel-title">üìã Questions</div>
        </div>
        <div class="questions-grid" id="questionsGrid"></div>
        <div class="panel-legend">
          <div class="legend-item"><div class="legend-dot current"></div> Current</div>
          <div class="legend-item"><div class="legend-dot answered"></div> Answered</div>
          <div class="legend-item"><div class="legend-dot unanswered"></div> Pending</div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <div class="q-header">
          <div class="q-header-top">
            <div class="q-count">
              <span class="current" id="qNum">0</span>
              <span class="total" id="qTotal">/ 26</span>
            </div>
            <div class="header-buttons">
              <button class="btn btn-gold btn-sm" onclick="endQuiz()">üèÜ End Quiz</button>
            </div>
          </div>
          <div class="q-progress">
            <div class="progress-track">
              <div class="progress-fill" id="progressBar"></div>
            </div>
          </div>
        </div>
        
        <!-- Team Selection Display - shown when waiting for team to pick question -->
        <div class="team-selection-display" id="teamSelectionDisplay">
          <div class="selection-avatar" id="selectionAvatar">ü¶Å</div>
          <div class="selection-label">CURRENT TURN</div>
          <div class="selection-team-name" id="selectionTeamName">Alpha</div>
          <div class="selection-instruction">Please select a Question Number from the sidebar to begin.</div>
        </div>
        
        <!-- Question Content - shown after question is selected -->
        <div class="question-content" id="questionContent" style="display:none;">
          <div class="category-badge" id="category">üí° Category</div>
          
          <div class="question-card glass-card compact">
            <div class="q-number" id="qBadge">Q1</div>
            <div class="question-row">
              <h2 class="question-text" id="qText"></h2>
              <div class="expand-trigger" id="expandTrigger" onclick="toggleOptions()">
                <svg class="expand-chevron" id="expandChevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                  <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
              </div>
            </div>
          </div>
          
          <div class="options-container" id="optionsContainer">
            <div class="options-grid" id="optionsGrid"></div>
          </div>
          
          <!-- Show which team answered if already answered -->
          <div class="question-answered-info" id="questionAnsweredInfo" style="display:none;">
            <div class="qa-item"><span class="qa-label">Ans:</span> <span class="qa-value" id="qaAnswer"></span></div>
            <div class="qa-item"><span class="qa-label">Team:</span> <span class="qa-value" id="qaTeamName"></span></div>
            <div class="qa-item"><span class="qa-label">Score:</span> <span class="qa-value" id="qaPoints"></span></div>
          </div>
          
          <div class="actions-row" id="actionsRow">
            <button class="btn btn-gold btn-sm" onclick="showScreen('reveal')">Reveal Answer ‚Üí</button>
          </div>
          
          <div class="scoring-info glass-card compact" id="scoringInfo">
            <div>‚ú® No options: <strong>+2</strong> / <strong>-1</strong></div>
            <div>üí° With options: <strong>+1</strong> / <strong>-1</strong></div>
          </div>
        </div>
      </div>

      <!-- Teams Panel (Right Side) -->
      <div class="teams-panel">
        <div class="teams-panel-title">Scores</div>
        <div class="teams-strip" id="teamsStrip"></div>
      </div>
    </div>

    <!-- Mobile Panel Toggle -->
    <button class="panel-toggle" onclick="togglePanel()">üìã</button>
  </div>

  <!-- REVEAL + AWARD -->
  <div id="reveal" class="screen">
    <div class="reveal-content">
      <div class="answer-showcase glass-card">
        <div class="answer-image" id="ansImageContainer">
          <span class="fallback-icon" id="fallbackIcon">ü§ñ</span>
        </div>
        <div class="answer-details">
          <div class="answer-badge" id="ansBadge">Option C</div>
          <h2 class="answer-title" id="ansTitle"></h2>
          <p class="answer-desc" id="ansDesc"></p>
        </div>
      </div>
      
      <div class="assign-section">
        <div class="teams-grid" id="teamsGrid"></div>
        
        <!-- Mobile Action Panel - BIG BUTTONS -->
        <div class="mobile-action-panel" id="mobileActionPanel">
          <div class="selected-team-info">
            <span class="selected-team-icon" id="selectedTeamIcon"></span>
            <span class="selected-team-name" id="selectedTeamName"></span>
          </div>
          <div class="action-buttons">
            <button class="action-btn correct" onclick="awardSelected(true)">
              <span class="pts" id="correctPtsBtn">+2</span>
              <span class="label">Correct ‚úì</span>
            </button>
            <button class="action-btn wrong" onclick="awardSelected(false)">
              <span class="pts" id="wrongPtsBtn">-1</span>
              <span class="label">Wrong ‚úó</span>
            </button>
          </div>
        </div>
        
        <div class="nav-btns">
          <button class="btn btn-secondary" onclick="backToQuestion()">‚Üê Back to Question</button>
          <button class="btn btn-secondary" id="nextQBtn" onclick="goNextQuestion()">Next Question ‚Üí</button>
          <button class="btn btn-gold" onclick="endQuiz()">üèÜ End Quiz</button>
        </div>
      </div>
    </div>
  </div>

  <!-- TIEBREAKER -->
  <div id="tiebreaker" class="screen">
    <div class="tiebreaker-content">
      <div class="tie-icon">‚öîÔ∏è</div>
      <h1 class="tie-title">TIEBREAKER!</h1>
      <p class="tie-subtitle">These teams are tied! Assign bonus points to determine the winner.</p>
      
      <div class="teams-grid tiebreaker-grid" id="tiedTeamsGrid"></div>
    </div>
  </div>

  <!-- WINNER -->
  <div id="winner" class="screen">
    <div class="winner-content">
      <div class="trophy-container">
        <div class="trophy-glow"></div>
        <div class="trophy-icon">üèÜ</div>
      </div>
      <p class="winner-label">And the winner is...</p>
      <h1 class="champion-title">CHAMPION</h1>
      
      <div class="winner-layout">
        <div class="winner-showcase" id="winnerCard">
          <div class="winner-icon" id="winIcon"></div>
          <div class="winner-name" id="winName"></div>
          <div class="winner-score" id="winScore"></div>
        </div>
        
        <div class="leaderboard-side">
          <h3 class="final-title">üèÜ Final Leaderboard</h3>
          <div class="final-leaderboard" id="finalLeaderboard"></div>
        </div>
      </div>
      
      <button class="btn btn-gold" onclick="restart()">üîÑ Restart</button>
    </div>
  </div>

  <script>
    // Teams can have either 'icon' (emoji) or 'image' (URL) for their avatar
    // To use an image instead of emoji, add 'image' property with URL
    // Example: { id: 0, name: 'Alpha', score: 0, image: 'https://example.com/avatar.png', bg: '...' }
    const teams = [
      { id: 0, name: 'Alpha', score: 0, icon: 'ü¶Å', bg: 'linear-gradient(135deg, #FFD700 0%, #FFA500 100%)' },
      { id: 1, name: 'Beta', score: 0, icon: 'üêº', bg: 'linear-gradient(135deg, #9B59B6 0%, #8E44AD 100%)' },
      { id: 2, name: 'Gamma', score: 0, icon: 'ü¶Ö', bg: 'linear-gradient(135deg, #3498DB 0%, #2980B9 100%)' },
      { id: 3, name: 'Delta', score: 0, icon: 'üêò', bg: 'linear-gradient(135deg, #E74C3C 0%, #C0392B 100%)' },
      { id: 4, name: 'Epsilon', score: 0, icon: 'üêπ', bg: 'linear-gradient(135deg, #1ABC9C 0%, #16A085 100%)' },
      { id: 5, name: 'Zeta', score: 0, icon: 'üêØ', bg: 'linear-gradient(135deg, #F39C12 0%, #D68910 100%)' },
      { id: 6, name: 'Omega', score: 0, icon: 'ü¶à', bg: 'linear-gradient(135deg, #E91E63 0%, #AD1457 100%)' }
    ];

    // Helper function to get team avatar HTML (image or icon)
    function getTeamAvatar(team, className = 'team-icon') {
      if (team.image) {
        return `<img src="${team.image}" alt="${team.name}" class="team-image">`;
      }
      return `<div class="${className}">${team.icon}</div>`;
    }

    const questions = [
      { cat: 'AI Requirements', q: 'When a stakeholder says "this system must be intelligent," what is the most accurate interpretation?', opts: ['It should automate everything', 'It should replace humans', 'It should perform tasks that normally require human intelligence', 'It should replicate human thinking and emotions'], ans: 'It should perform tasks that normally require human intelligence', icon: 'üß†', desc: 'In requirements and AI contexts, an "intelligent" system is one that can handle activities such as learning from data, reasoning, problem solving, or decision-making, which are typically associated with human intelligence, not one that fully automates everything, replaces humans, or replicates human emotions.\n\nExamples:\n‚Ä¢ Image recognition\n‚Ä¢ Language translation\n‚Ä¢ Medical diagnosis support' },
      { cat: 'Turing Test', q: 'If a system passes the Turing Test, what does it NOT guarantee?', opts: ['It can sound human', 'It can reason correctly', 'It can generate language', 'It can fool users'], ans: 'It can reason correctly', icon: 'ü§ñ', desc: 'The Turing Test measures appearance of intelligence, not correctness or understanding. Passing the Turing Test only shows that a system can use language in a way that fools human judges into thinking it is human (that it can "sound human" and "fool users"). It does not guarantee genuine reasoning ability or that its answers are logically or factually correct.\n\nExamples:\n‚Ä¢ ELIZA fooled users without understanding\n‚Ä¢ Modern chatbots can sound confident while hallucinating' },
      { cat: 'Machine Learning', q: 'A team says: "We\'ll use ML so we don\'t need rules." What are they underestimating?', opts: ['Infrastructure cost', 'Ongoing data quality and monitoring', 'UI complexity', 'Model size'], ans: 'Ongoing data quality and monitoring', icon: 'üìä', desc: 'ML replaces explicit rules with patterns learned from data, which requires continuous monitoring. Using ML does not eliminate the need for rules; it often adds the need for new kinds of rules and processes around data quality checks, drift detection, labeling standards, and continuous monitoring of inputs and model performance over time. This means teams frequently underestimate how much ongoing work is required to keep data clean, stable, and reliable so the model continues to behave well in production.\n\nExamples:\n‚Ä¢ Spam filters degrading due to data drift\n‚Ä¢ Recommendation systems needing retraining' },
      { cat: 'Reinforcement Learning', q: 'Why is reinforcement learning risky outside controlled environments?', opts: ['It needs GPUs', 'Rewards can be poorly defined', 'Training is slow', 'Models are large'], ans: 'Rewards can be poorly defined', icon: 'üéÆ', desc: 'Reinforcement learning optimizes exactly what is rewarded ‚Äî not necessarily what is intended. Reinforcement learning is risky in the real world because if the reward function is even slightly mis-specified, the agent can learn harmful or unintended behaviors while still maximizing that flawed reward, leading to side effects, reward hacking, or unsafe exploration.\n\nExamples:\n‚Ä¢ AI gaming reward systems\n‚Ä¢ Systems exploiting unintended shortcuts' },
      { cat: 'Neural Networks', q: 'Why are neural networks hard to fully explain?', opts: ['They use too much data', 'They involve many non-linear transformations', 'They require GPUs', 'They retrain automatically'], ans: 'They involve many non-linear transformations', icon: 'üï∏Ô∏è', desc: 'Neural networks distribute logic across layers and weights, not explicit steps. Neural networks apply layers of non-linear activation functions to inputs, creating very complex internal representations that are hard to map to simple human-understandable rules. This layered non-linearity makes it difficult to trace exactly how any specific input leads to a particular output in a fully transparent way.\n\nExamples:\n‚Ä¢ Credit scoring models hard to audit\n‚Ä¢ Medical AI decisions difficult to justify step-by-step' },
      { cat: 'NLP', q: 'Which NLP failure is most harmful in production systems?', opts: ['High accuracy on common cases, poor performance on rare ones', 'Occasional grammar errors in long responses', 'Confident responses without reliable source grounding', 'Model refusals on ambiguous queries'], ans: 'Confident responses without reliable source grounding', icon: 'üí¨', desc: 'Users tolerate slowness or minor errors, but confident wrong answers destroy trust. In production, NLP systems that produce incorrect outputs while sounding highly confident can mislead users, spread misinformation, and cause serious harm, especially in high-stakes domains like health, finance, or security.\n\nExamples:\n‚Ä¢ Legal chatbots hallucinating case law\n‚Ä¢ Medical symptom checkers sounding certain but wrong' },
      { cat: 'Deep Learning', q: 'What does "deep" practically enable in neural networks?', opts: ['Faster training', 'Learning layered abstractions', 'Less data usage', 'Simpler models'], ans: 'Learning layered abstractions', icon: 'üìö', desc: 'Each layer learns progressively higher-level features. In practice, "deep" means stacking many layers so the network can build hierarchical representations: lower layers learn simple features, and higher layers combine them into more abstract concepts, enabling it to model very complex patterns.\n\nExamples:\n‚Ä¢ Vision: edges ‚Üí shapes ‚Üí objects\n‚Ä¢ Language: characters ‚Üí words ‚Üí meaning' },
      { cat: 'AGI vs Narrow AI', q: 'What is the key difference between Narrow AI and Artificial General Intelligence (AGI)?', opts: ['Speed', 'Programming language', 'Training data', 'Scope of cognitive abilities'], ans: 'Scope of cognitive abilities', icon: 'üåê', desc: 'Narrow AI is designed to perform specific, limited tasks, while Artificial General Intelligence (AGI) would be able to understand, learn, and apply knowledge across many domains with human-like flexibility and reasoning.\n\nExamples:\n‚Ä¢ Letting chatbots make policy decisions\n‚Ä¢ Assuming AI "understands" intent' },
      { cat: 'Algorithmic Bias', q: 'An AI matches historical data perfectly but produces biased outcomes. What failed?', opts: ['The model', 'The training process', 'The evaluation criteria', 'Infrastructure'], ans: 'The evaluation criteria', icon: '‚öñÔ∏è', desc: 'Accuracy against past data does not guarantee fairness. The model and training process did what they were asked to do‚Äîfit historical data‚Äîbut the evaluation failed to check for fairness, bias, and downstream impact, so biased behavior was not detected or prevented.\n\nExamples:\n‚Ä¢ Hiring systems reinforcing gender bias\n‚Ä¢ Lending models replicating redlining' },
      { cat: 'Data Ethics', q: 'What is the most immediate ethical risk of AI trained on real-world data?', opts: ['Energy usage', 'Job loss', 'Amplifying existing bias', 'Sentience'], ans: 'Amplifying existing bias', icon: '‚ö†Ô∏è', desc: 'AI scales whatever patterns exist in data ‚Äî including harmful ones. When AI is trained on real-world data, it can inherit and then amplify historical and societal biases present in that data, leading to systematically unfair or discriminatory outcomes for certain groups.\n\nExamples:\n‚Ä¢ Predictive policing\n‚Ä¢ Unequal healthcare recommendations' },
      { cat: 'Computer Vision', q: 'Why should AI systems that analyze medical images not operate fully autonomously?', opts: ['High latency', 'Model size', 'Risk of false confidence', 'Infrastructure cost'], ans: 'Risk of false confidence', icon: 'üè•', desc: 'Medical imaging AI systems often output predictions with high confidence scores that can mislead clinicians into over-relying on them, even when the model is wrong due to edge cases, poor generalization, or unseen data distributions. Human oversight is essential to catch these errors and provide context-specific judgment that AI lacks. Autonomous operation amplifies harm potential in diagnostics where missing a lesion or false positive can directly impact patient treatment.\n\nExamples:\n‚Ä¢ Missed fractures delaying treatment\n‚Ä¢ False positives leading to unnecessary procedures' },
      { cat: 'Turing Test', q: 'What problem does the Turing Test not help us evaluate today?', opts: ['Human-like conversation', 'Logical correctness', 'Language fluency', 'Ability to fool users'], ans: 'Logical correctness', icon: 'ü§ñ', desc: 'The Turing Test evaluates whether a machine can engage in human-like conversation through text, focusing on indistinguishability from a human rather than verifying the factual accuracy, logical validity, or reasoning depth of its responses. Modern AI systems routinely pass variants of it by mimicking fluency and deception, but they can still produce logically flawed or incorrect outputs without detection by the test.\n\nExamples:\n‚Ä¢ ELIZA fooled users without understanding\n‚Ä¢ Modern chatbots can pass conversation but hallucinate facts' },
      { cat: 'Activation Functions', q: 'What is the main purpose of an activation function in a neural network?', opts: ['Adjust weights during training', 'Introduce non-linearity', 'Calculate total error', 'Initialize parameters'], ans: 'Introduce non-linearity', icon: '‚ö°', desc: 'Without non-linearity, multiple layers behave like a single layer.\n\nExamples:\n‚Ä¢ ReLU\n‚Ä¢ Sigmoid\n‚Ä¢ Tanh' },
      { cat: 'Unsupervised Learning', q: 'Why is unsupervised learning risky for direct business decisions?', opts: ['Low accuracy', 'Harder to validate correctness', 'High compute cost', 'Poor UX'], ans: 'Harder to validate correctness', icon: 'üîç', desc: 'Without ground truth, interpretation becomes subjective. Unsupervised learning identifies patterns like clusters or anomalies without labeled ground truth, making it challenging to confirm if those patterns accurately represent reality or useful business insights. Without clear validation metrics or human judgment, these outputs risk leading to misguided decisions such as flawed customer segments or undetected errors. In contrast, supervised methods have explicit accuracy checks against known labels.\n\nExamples:\n‚Ä¢ Customer clusters that look logical but aren\'t actionable\n‚Ä¢ Segments shifting with new data' },
      { cat: 'Large Language Models', q: 'What distinguishes Large Language Models (LLMs) from earlier NLP systems?', opts: ['Single-task specialization', 'Hard-coded grammar rules', 'Massive scale of parameters and training data', 'Ability to train on personal computers'], ans: 'Massive scale of parameters and training data', icon: 'üìö', desc: 'Large Language Models (LLMs) like GPT series differ from traditional NLP by using billions or trillions of parameters trained on internet-scale text corpora, enabling emergent generalization across tasks via transformer architectures. Earlier systems relied on smaller models with rule-based parsing, statistical features, or task-specific training that couldn\'t capture broad contextual understanding.\n\nExamples:\n‚Ä¢ GPT-style models\n‚Ä¢ Internet-scale training data' },
      { cat: 'ImageNet', q: 'What major project co-founded by Dr. Fei-Fei Li advanced computer vision?', opts: ['AlphaGo', 'MNIST', 'CIFAR-10', 'ImageNet'], ans: 'ImageNet', icon: 'üñºÔ∏è', desc: 'Dr. Fei-Fei Li co-founded ImageNet, a massive, labeled image dataset that fueled the deep learning (Data driven learning) revolution in computer vision through the annual ImageNet challenge.\n\nExamples:\n‚Ä¢ 14M+ labeled images\n‚Ä¢ Standard benchmarking across researchers' },
      { cat: 'AI Terms', q: 'What does "NLP" stand for?', opts: ['Natural Language Processing', 'Neural Learning Protocol', 'Network Logic Program', 'Numeric Logic Processing'], ans: 'Natural Language Processing', icon: 'üí¨', desc: 'NLP = Natural Language Processing.' },
      { cat: 'AI Pioneers', q: 'Who is a "Godfather of Deep Learning"?', opts: ['Geoffrey Hinton', 'Steve Jobs', 'Larry Page', 'Tim Cook'], ans: 'Geoffrey Hinton', icon: 'üß†', desc: 'Geoffrey Hinton won Nobel Prize in Physics 2024.' },
      { cat: 'Open Source', q: "What is Meta's open-source LLM called?", opts: ['LLaMA', 'Falcon', 'Claude', 'PaLM'], ans: 'LLaMA', icon: 'ü¶ô', desc: 'LLaMA = Large Language Model Meta AI.' },
      { cat: 'AI Tech', q: 'What generates AI images from text?', opts: ['Diffusion Models', 'Blockchain', 'Quantum Computing', 'Edge Computing'], ans: 'Diffusion Models', icon: 'üñºÔ∏è', desc: 'Diffusion Models power Stable Diffusion, DALL-E, Midjourney.' },
      { cat: 'AI Companies', q: 'Who created Stable Diffusion?', opts: ['Stability AI', 'OpenAI', 'Google', 'Microsoft'], ans: 'Stability AI', icon: '‚ö°', desc: 'Stability AI made the open-source Stable Diffusion.' },
      { cat: 'AI Concepts', q: 'What does "AGI" stand for?', opts: ['Artificial General Intelligence', 'Advanced Graphics Interface', 'Automated Global Integration', 'Applied Genetic Intelligence'], ans: 'Artificial General Intelligence', icon: 'üåê', desc: 'AGI = human-level AI across all domains.' },
      { cat: 'AI Training', q: 'What is RLHF?', opts: ['Reinforcement Learning from Human Feedback', 'Recursive Logic for Hybrid Functions', 'Random Layer Hidden Features', 'Rapid Learning Heuristic Framework'], ans: 'Reinforcement Learning from Human Feedback', icon: 'üëç', desc: 'RLHF aligns AI with human preferences.' },
      { cat: 'AI Science', q: 'Which AI solved protein folding?', opts: ['AlphaFold', 'AlphaGo', 'AlphaStar', 'AlphaZero'], ans: 'AlphaFold', icon: 'üß¨', desc: 'AlphaFold by DeepMind revolutionized biology.' },
      { cat: 'AI Chatbots', q: "What is xAI's chatbot called?", opts: ['Grok', 'Gemini', 'Claude', 'Copilot'], ans: 'Grok', icon: '‚úñÔ∏è', desc: 'Grok is xAI\'s witty AI assistant.' },
      { cat: 'AI History', q: 'When was "AI" first coined?', opts: ['1956', '1969', '1984', '2001'], ans: '1956', icon: 'üìÖ', desc: 'The term was coined at Dartmouth Conference in 1956.' }
    ];

    // Track question states
    const questionStates = questions.map(() => ({
      answered: false,
      skipped: false,
      teamId: null,
      correct: null,
      optionsUsed: false
    }));

    let currentQ = 0;
    let optionsShown = false;
    let optionsUsed = false;
    let selectedTeamId = null;
    let confettiShown = false;
    let confettiRunning = false;
    let currentTeamIndex = 0;
    let questionRevealed = false;

    const $ = id => document.getElementById(id);
    const getLetter = i => String.fromCharCode(65 + i);
    const getRank = i => ['ü•á','ü•à','ü•â','4Ô∏è‚É£','5Ô∏è‚É£','6Ô∏è‚É£','7Ô∏è‚É£'][i] || '';
    const getSorted = () => [...teams].sort((a,b) => b.score - a.score);
    const isMobile = () => window.innerWidth <= 1024;

    function showScreen(id) {
      const currentScreen = document.querySelector('.screen.active');
      const targetScreen = $(id);
      
      if (currentScreen === targetScreen) {
        if (id === 'question') {
          if (!questionRevealed) showTeamSelection();
          else updateQuestion();
        }
        if (id === 'reveal') updateReveal();
        if (id === 'winner') updateWinner();
        if (id === 'tiebreaker') updateTiebreaker();
        return;
      }
      
      // No animation for reveal - just show it instantly
      if (id === 'reveal') {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        targetScreen.classList.add('active');
        updateReveal();
        return;
      }
      
      // Handle reveal to question transition (Back to Question) - no animation
      if (currentScreen && currentScreen.id === 'reveal' && id === 'question') {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        targetScreen.classList.add('active');
        if (questionRevealed) updateQuestion();
        else showTeamSelection();
        return;
      }
      
      // Default transition for other screens (intro, winner, tiebreaker)
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      targetScreen.classList.add('active');
      if (id === 'question') {
        if (!questionRevealed) showTeamSelection();
        else updateQuestion();
      }
      if (id === 'reveal') updateReveal();
      if (id === 'winner') updateWinner();
      if (id === 'tiebreaker') updateTiebreaker();
    }

    function startGame() {
      teams.forEach(t => t.score = 0);
      questionStates.forEach(s => {
        s.answered = false;
        s.skipped = false;
        s.teamId = null;
        s.correct = null;
        s.optionsUsed = false;
        s.points = 0;
      });
      currentQ = 0;
      optionsShown = false;
      optionsUsed = false;
      currentTeamIndex = 0;
      questionRevealed = false;
      showScreen('question');
    }

    function showTeamSelection() {
      questionRevealed = false;
      $('teamSelectionDisplay').style.display = 'flex';
      $('questionContent').style.display = 'none';
      
      // Update team display
      const team = teams[currentTeamIndex];
      $('selectionTeamName').textContent = team.name;
      
      // Handle image or icon
      if (team.image) {
        $('selectionAvatar').innerHTML = `<img src="${team.image}" alt="${team.name}">`;
      } else {
        $('selectionAvatar').innerHTML = team.icon || 'üéØ';
      }
      
      updateSidePanel();
      updateLiveLeaderboard();
      
      // Update progress
      const completed = questionStates.filter(s => s.answered || s.skipped).length;
      $('progressBar').style.width = (completed / questions.length * 100) + '%';
      $('qNum').textContent = completed;
    }

    function revealQuestion(index) {
      if (questionStates[index].answered) return;
      
      currentQ = index;
      questionRevealed = true;
      optionsShown = false;
      optionsUsed = false;
      
      $('teamSelectionDisplay').style.display = 'none';
      $('questionContent').style.display = 'flex';
      
      // Reset options
      $('optionsContainer').classList.remove('show');
      $('expandChevron').classList.remove('expanded');
      
      updateQuestion();
    }

    function updateSidePanel() {
      const grid = $('questionsGrid');
      grid.innerHTML = questions.map((q, i) => {
        const state = questionStates[i];
        let statusClass = '';
        let teamHtml = '';

        if (state.answered) {
          statusClass = 'answered';
          const team = teams.find(t => t.id === state.teamId);
          if (team) {
            const ptsDisplay = state.points > 0 ? `+${state.points}` : state.points;
            teamHtml = `<div class="q-tile-team">${team.name} <span class="q-tile-pts ${state.correct ? 'correct' : 'wrong'}">${ptsDisplay}</span></div>`;
          }
        } else if (state.skipped) {
          statusClass = 'skipped';
        }

        // Only show active when question is revealed
        if (i === currentQ && questionRevealed) statusClass += ' active';

        return `
          <div class="q-tile ${statusClass}" onclick="goToQuestion(${i})" title="Q${i + 1}: ${q.cat}">
            <div class="q-tile-num">${i + 1}</div>
            ${teamHtml}
          </div>
        `;
      }).join('');
    }

    function goToQuestion(index) {
      // If question is already answered, show the question info (read-only view)
      if (questionStates[index].answered) {
        currentQ = index;
        questionRevealed = true;
        $('teamSelectionDisplay').style.display = 'none';
        $('questionContent').style.display = 'flex';
        updateQuestion();
        if (isMobile()) togglePanel();
        return;
      }
      
      // If we're in team selection mode, reveal the question
      if (!questionRevealed) {
        revealQuestion(index);
        if (isMobile()) togglePanel();
        return;
      }
      
      // Otherwise don't allow switching (question is revealed for current team)
      return;
    }

    function togglePanel() {
      $('sidePanel').classList.toggle('show');
      $('panelOverlay').classList.toggle('show');
    }

    function updateQuestion() {
      const q = questions[currentQ];
      const state = questionStates[currentQ];
      
      $('qNum').textContent = currentQ + 1;
      
      // Calculate progress based on answered + skipped questions
      const completed = questionStates.filter(s => s.answered || s.skipped).length;
      $('progressBar').style.width = (completed / questions.length * 100) + '%';
      
      $('category').innerHTML = 'üí° ' + q.cat;
      $('qBadge').textContent = 'Q' + (currentQ + 1);
      $('qText').textContent = q.q;
      
      // Build options
      $('optionsGrid').innerHTML = q.opts.map((opt, i) => `
        <div class="option-card glass-card">
          <div class="option-letter">${getLetter(i)}</div>
          <div class="option-text">${opt}</div>
        </div>
      `).join('');
      
      // Reset options state
      $('optionsContainer').classList.remove('show');
      $('expandChevron').classList.remove('expanded');
      optionsShown = false;
      
      // Show answered info if question was already answered
      const answeredInfo = $('questionAnsweredInfo');
      const actionsRow = $('actionsRow');
      const scoringInfo = $('scoringInfo');
      
      if (state.answered) {
        const team = teams.find(t => t.id === state.teamId);
        
        // Show the correct answer
        $('qaAnswer').textContent = q.ans;
        
        // Show team name
        $('qaTeamName').textContent = team.name;
        
        // Calculate and show points
        const pts = state.points || (state.correct ? (state.optionsUsed ? +1 : +2) : -1);
        const pointsEl = $('qaPoints');
        pointsEl.textContent = (pts > 0 ? '+' : '') + pts;
        pointsEl.className = 'qa-value ' + (pts < 0 ? 'negative' : '');
        
        answeredInfo.style.display = 'flex';
        actionsRow.style.display = 'none';
        scoringInfo.style.display = 'none';
      } else {
        answeredInfo.style.display = 'none';
        actionsRow.style.display = 'flex';
        scoringInfo.style.display = 'flex';
      }
      
      updateSidePanel();
      updateLiveLeaderboard();
    }

    function updateLiveLeaderboard() {
      const strip = $('teamsStrip');
      if (!strip) return;
      
      const sorted = getSorted();
      const maxScore = Math.max(...sorted.map(t => t.score));
      
      strip.innerHTML = sorted.map((t, i) => `
        <div class="team-chip ${t.score > 0 && t.score === maxScore ? 'leading' : ''}">
          <span class="team-chip-rank">${i + 1}</span>
          <span class="team-chip-name">${t.name}</span>
          <span class="team-chip-score">${t.score}</span>
        </div>
      `).join('');
    }

    function toggleOptions() {
      optionsShown = !optionsShown;
      const container = $('optionsContainer');
      const arrow = $('expandChevron');
      
      if (optionsShown) {
        optionsUsed = true;
        questionStates[currentQ].optionsUsed = true;
        container.classList.add('show');
        arrow.classList.add('expanded');
      } else {
        container.classList.remove('show');
        arrow.classList.remove('expanded');
      }
    }

    function goPrevious() {
      if (currentQ > 0) {
        animateToQuestion(currentQ - 1, 'left');
      }
    }

    function goNext() {
      if (currentQ < questions.length - 1) {
        animateToQuestion(currentQ + 1, 'right');
      }
    }

    function animateToQuestion(targetQ, direction) {
      const mainContent = document.querySelector('.main-content');
      // For 'right' (next): current goes left (-50), new comes from right (+50)
      // For 'left' (prev): current goes right (+50), new comes from left (-50)
      const slideOut = direction === 'right' ? '-50px' : '50px';
      const slideIn = direction === 'right' ? '50px' : '-50px';
      
      // Animate out
      mainContent.style.transition = 'opacity 0.25s ease, transform 0.25s ease';
      mainContent.style.opacity = '0';
      mainContent.style.transform = `translateX(${slideOut})`;
      
      setTimeout(() => {
        currentQ = targetQ;
        optionsShown = false;
        optionsUsed = questionStates[currentQ].optionsUsed || false;
        updateQuestion();
        
        // Set up for animate in
        mainContent.style.transition = 'none';
        mainContent.style.transform = `translateX(${slideIn})`;
        
        // Trigger animate in
        setTimeout(() => {
          mainContent.style.transition = 'opacity 0.25s ease, transform 0.25s ease';
          mainContent.style.opacity = '1';
          mainContent.style.transform = 'translateX(0)';
        }, 20);
      }, 250);
    }

    function skipQuestion() {
      questionStates[currentQ].skipped = true;
      goToNextAvailable();
    }

    function goToNextAvailable() {
      // Find next unanswered question
      let nextQ = currentQ + 1;
      while (nextQ < questions.length && (questionStates[nextQ].answered || questionStates[nextQ].skipped)) {
        nextQ++;
      }
      
      if (nextQ >= questions.length) {
        // Check if all questions are done
        const allDone = questionStates.every(s => s.answered || s.skipped);
        if (allDone) {
          showScreen('winner');
        } else {
          // Find first unanswered
          nextQ = questionStates.findIndex(s => !s.answered && !s.skipped);
          if (nextQ === -1) {
            showScreen('winner');
          } else {
            currentQ = nextQ;
            optionsShown = false;
            optionsUsed = questionStates[currentQ].optionsUsed || false;
            showScreen('question');
          }
        }
      } else {
        currentQ = nextQ;
        optionsShown = false;
        optionsUsed = questionStates[currentQ].optionsUsed || false;
        showScreen('question');
      }
    }

    function updateReveal() {
      const q = questions[currentQ];
      const state = questionStates[currentQ];
      
      $('fallbackIcon').textContent = q.icon;
      $('ansTitle').textContent = q.ans;
      $('ansDesc').innerHTML = q.desc.replace(/\n/g, '<br>');
      
      // Set option letter badge (Option A, B, C, or D)
      const ansIndex = q.opts.indexOf(q.ans);
      const optionLetter = String.fromCharCode(65 + ansIndex); // A, B, C, D
      $('ansBadge').textContent = 'Option ' + optionLetter;
      
      selectedTeamId = null;
      $('mobileActionPanel').classList.remove('show');
      
      const usedOpts = state.optionsUsed || optionsUsed;
      const correctPts = usedOpts ? '+1' : '+2';
      const wrongPts = '-1';
      
      // Update mobile action panel buttons
      $('correctPtsBtn').textContent = correctPts;
      $('wrongPtsBtn').textContent = wrongPts;
      
      // Show/hide next button based on if last question
      $('nextQBtn').style.display = currentQ >= questions.length - 1 ? 'none' : 'inline-block';
      
      // Check if already answered
      if (state.answered) {
        const answeredTeam = teams.find(t => t.id === state.teamId);
        const resultText = state.correct ? '‚úì Correct' : '‚úó Wrong';
        const resultClass = state.correct ? 'correct' : 'wrong';
        const teamAvatarHtml = answeredTeam.image 
          ? `<img src="${answeredTeam.image}" alt="${answeredTeam.name}" class="answered-team-image">`
          : `<span class="answered-team-icon">${answeredTeam.icon}</span>`;
        
        $('teamsGrid').innerHTML = `
          <div class="already-answered">
            <div class="answered-label">Already Answered</div>
            <div class="answered-team">
              ${teamAvatarHtml}
              <span class="answered-team-name">${answeredTeam.name}</span>
              <span class="answered-result ${resultClass}">${resultText}</span>
            </div>
          </div>
        `;
        $('mobileActionPanel').style.display = 'none';
      } else {
        $('mobileActionPanel').style.display = '';
        
        // Add no-hover class to prevent immediate hover on page load
        $('teamsGrid').classList.add('no-hover');
        
        $('teamsGrid').innerHTML = teams.map(t => {
          const avatarHtml = t.image 
            ? `<img src="${t.image}" alt="${t.name}" class="team-image">`
            : `<div class="team-icon">${t.icon}</div>`;
          const hoverAvatarHtml = t.image 
            ? `<img src="${t.image}" alt="${t.name}" class="hover-team-image">`
            : `<span>${t.icon}</span>`;
          return `
            <div class="team-card" data-id="${t.id}" onclick="selectTeam(${t.id})">
              ${avatarHtml}
              <div class="team-name">${t.name}</div>
              <div class="team-score">${t.score} pts</div>
              <div class="team-hover">
                <div class="hover-team-name">${hoverAvatarHtml} ${t.name}</div>
                <button class="hover-btn correct" onclick="event.stopPropagation(); award(${t.id}, true)">‚úì ${correctPts}</button>
                <button class="hover-btn wrong" onclick="event.stopPropagation(); award(${t.id}, false)">‚úó ${wrongPts}</button>
              </div>
            </div>
          `;
        }).join('');
        
        // Remove no-hover class after a short delay to enable hover
        setTimeout(() => {
          $('teamsGrid').classList.remove('no-hover');
        }, 400);
      }
    }

    function selectTeam(teamId) {
      selectedTeamId = teamId;
      const team = teams.find(t => t.id === teamId);
      
      // Update selection UI
      document.querySelectorAll('.team-card').forEach(c => c.classList.remove('selected'));
      document.querySelector(`.team-card[data-id="${teamId}"]`).classList.add('selected');
      
      // Show mobile action panel
      const iconEl = $('selectedTeamIcon');
      if (team.image) {
        iconEl.innerHTML = `<img src="${team.image}" alt="${team.name}" class="selected-team-img">`;
      } else {
        iconEl.textContent = team.icon;
      }
      $('selectedTeamName').textContent = team.name;
      $('mobileActionPanel').classList.add('show');
      
      // Scroll to action panel on mobile
      if (isMobile()) {
        setTimeout(() => {
          $('mobileActionPanel').scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 100);
      }
    }

    function awardSelected(correct) {
      if (selectedTeamId === null) return;
      award(selectedTeamId, correct);
    }

    function award(teamId, correct) {
      const team = teams.find(t => t.id === teamId);
      const state = questionStates[currentQ];
      const usedOpts = state.optionsUsed || optionsUsed;
      const pts = correct ? (usedOpts ? 1 : 2) : -1;
      team.score += pts;
      
      // Mark question as answered
      state.answered = true;
      state.skipped = false;
      state.teamId = teamId;
      state.correct = correct;
      state.points = pts;
      
      showToast(team.icon, team.name, pts);
      updateLiveLeaderboard();
      updateSidePanel();
      
      // Go to next question with animation
      setTimeout(() => {
        goToNextWithAnimation();
      }, 800);
    }

    function goToNextWithAnimation() {
      // Check if all questions done
      const allDone = questionStates.every(s => s.answered || s.skipped);
      if (allDone) {
        showScreen('winner');
        return;
      }
      
      // Advance to next team
      currentTeamIndex = (currentTeamIndex + 1) % teams.length;
      
      // Animate out reveal content
      const revealContent = document.querySelector('.reveal-content');
      if (revealContent) {
        revealContent.style.transition = 'opacity 0.25s ease, transform 0.25s ease';
        revealContent.style.opacity = '0';
        revealContent.style.transform = 'translateX(-50px)';
      }
      
      setTimeout(() => {
        // Switch to question screen with team selection
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        $('question').classList.add('active');
        
        // Show team selection mode
        showTeamSelection();
        
        // Set up initial state for animation in from right
        const mainContent = document.querySelector('.main-content');
        mainContent.style.transition = 'none';
        mainContent.style.opacity = '0';
        mainContent.style.transform = 'translateX(50px)';
        
        // Trigger animation in
        setTimeout(() => {
          mainContent.style.transition = 'opacity 0.25s ease, transform 0.25s ease';
          mainContent.style.opacity = '1';
          mainContent.style.transform = 'translateX(0)';
        }, 20);
        
        // Reset reveal content for next time
        if (revealContent) {
          revealContent.style.transition = 'none';
          revealContent.style.opacity = '1';
          revealContent.style.transform = 'translateX(0)';
        }
      }, 250);
    }

    function skipFromReveal() {
      questionStates[currentQ].skipped = true;
      goToNextWithAnimation();
    }

    function backToQuestion() {
      showScreen('question');
    }

    function goNextQuestion() {
      if (currentQ < questions.length - 1) {
        // Animate left to right: current goes left, new comes from right
        const revealContent = document.querySelector('.reveal-content');
        revealContent.style.transition = 'opacity 0.25s ease, transform 0.25s ease';
        revealContent.style.opacity = '0';
        revealContent.style.transform = 'translateX(-50px)';
        
        setTimeout(() => {
          currentQ++;
          optionsShown = false;
          optionsUsed = questionStates[currentQ].optionsUsed || false;
          
          document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
          $('question').classList.add('active');
          
          const mainContent = document.querySelector('.main-content');
          mainContent.style.transition = 'none';
          mainContent.style.opacity = '0';
          mainContent.style.transform = 'translateX(50px)';
          
          updateQuestion();
          
          setTimeout(() => {
            mainContent.style.transition = 'opacity 0.25s ease, transform 0.25s ease';
            mainContent.style.opacity = '1';
            mainContent.style.transform = 'translateX(0)';
          }, 20);
          
          // Reset reveal content
          revealContent.style.transition = 'none';
          revealContent.style.opacity = '1';
          revealContent.style.transform = 'translateX(0)';
        }, 250);
      }
    }

    function showToast(icon, name, pts) {
      $('toastIcon').textContent = icon;
      $('toastText').textContent = name;
      const ptsEl = $('toastPts');
      ptsEl.textContent = (pts > 0 ? '+' : '') + pts + ' pts';
      ptsEl.className = 'toast-pts ' + (pts > 0 ? 'pos' : pts < 0 ? 'neg' : 'zero');
      $('toast').classList.add('show');
      setTimeout(() => $('toast').classList.remove('show'), 900);
    }

    function openModal() {
      $('modalTeams').innerHTML = getSorted().map((t, i) => `
        <div class="modal-team ${i === 0 ? 'top' : ''}">
          <span class="modal-rank">${getRank(i)}</span>
          <span class="modal-icon">${t.icon}</span>
          <span class="modal-name">${t.name}</span>
          <span class="modal-pts">${t.score}</span>
        </div>
      `).join('');
      $('modalOverlay').classList.add('show');
    }

    function closeModal() {
      $('modalOverlay').classList.remove('show');
    }

    // Confetti animation
    function launchConfetti() {
      if (!confettiRunning) return;
      
      const container = $('confettiContainer');
      container.innerHTML = '';
      
      const colors = ['#FFD700', '#FFA500', '#FF6347', '#00CED1', '#9370DB', '#32CD32', '#FF69B4', '#00BFFF'];
      const shapes = ['square', 'circle'];
      
      for (let i = 0; i < 150; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        
        const color = colors[Math.floor(Math.random() * colors.length)];
        const shape = shapes[Math.floor(Math.random() * shapes.length)];
        const left = Math.random() * 100;
        const delay = Math.random() * 3;
        const duration = 3 + Math.random() * 3;
        const size = 8 + Math.random() * 12;
        
        confetti.style.cssText = `
          left: ${left}%;
          width: ${size}px;
          height: ${size}px;
          background: ${color};
          border-radius: ${shape === 'circle' ? '50%' : '2px'};
          animation-delay: ${delay}s;
          animation-duration: ${duration}s;
        `;
        
        container.appendChild(confetti);
        setTimeout(() => confetti.classList.add('active'), 10);
      }
      
      setTimeout(() => {
        if (confettiRunning) launchConfetti();
      }, 4000);
    }

    function updateWinner() {
      const sorted = getSorted();
      const winner = sorted[0];
      
      $('winnerCard').style.background = 'linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FFD700 100%)';
      
      // Handle winner icon/image
      const winIconEl = $('winIcon');
      if (winner.image) {
        winIconEl.innerHTML = `<img src="${winner.image}" alt="${winner.name}" class="winner-image">`;
      } else {
        winIconEl.textContent = winner.icon;
      }
      
      $('winName').textContent = winner.name;
      $('winScore').textContent = winner.score + ' points';
      
      $('finalLeaderboard').innerHTML = sorted.map((t, i) => {
        const cls = i === 0 ? 'gold' : i === 1 ? 'silver' : i === 2 ? 'bronze' : '';
        const iconHtml = t.image 
          ? `<img src="${t.image}" alt="${t.name}" class="final-image">`
          : `<span class="final-icon">${t.icon}</span>`;
        return `
          <div class="final-row ${cls}">
            <span class="final-rank">${getRank(i)}</span>
            ${iconHtml}
            <span class="final-name">${t.name}</span>
            <span class="final-score">${t.score} pts</span>
          </div>
        `;
      }).join('');
      
      // Launch confetti on first reveal
      if (!confettiShown) {
        confettiRunning = true;
        launchConfetti();
        confettiShown = true;
      }
    }

    function endQuiz() {
      // Check for ties at the top
      const sorted = getSorted();
      const topScore = sorted[0].score;
      const tiedTeams = sorted.filter(t => t.score === topScore);
      
      if (tiedTeams.length > 1) {
        // There's a tie - show tiebreaker
        showScreen('tiebreaker');
      } else {
        showScreen('winner');
      }
    }

    function updateTiebreaker() {
      const sorted = getSorted();
      const topScore = sorted[0].score;
      const tiedTeams = sorted.filter(t => t.score === topScore);
      
      const grid = $('tiedTeamsGrid');
      grid.classList.add('no-hover');
      
      grid.innerHTML = tiedTeams.map(t => {
        const avatarHtml = t.image 
          ? `<img src="${t.image}" alt="${t.name}" class="team-image">`
          : `<div class="team-icon">${t.icon}</div>`;
        const hoverAvatarHtml = t.image 
          ? `<img src="${t.image}" alt="${t.name}" class="hover-team-image">`
          : `<span>${t.icon}</span>`;
        return `
          <div class="team-card" data-id="${t.id}">
            ${avatarHtml}
            <div class="team-name">${t.name}</div>
            <div class="team-score">${t.score} pts</div>
            <div class="team-hover">
              <div class="hover-team-name">${hoverAvatarHtml} ${t.name}</div>
              <button class="hover-btn correct" onclick="event.stopPropagation(); tiebreakerAward(${t.id}, true)">‚úì +1</button>
              <button class="hover-btn wrong" onclick="event.stopPropagation(); tiebreakerAward(${t.id}, false)">‚úó -1</button>
            </div>
          </div>
        `;
      }).join('');
      
      // Remove no-hover class after a short delay to enable hover
      setTimeout(() => {
        grid.classList.remove('no-hover');
      }, 400);
    }

    function tiebreakerAward(teamId, isBonus) {
      const team = teams.find(t => t.id === teamId);
      team.score += isBonus ? 1 : -1;
      
      showToast(team.icon, team.name, isBonus ? 1 : -1);
      
      // Check if tie is broken
      setTimeout(() => {
        const sorted = getSorted();
        const topScore = sorted[0].score;
        const tiedTeams = sorted.filter(t => t.score === topScore);
        
        if (tiedTeams.length === 1) {
          // Tie is broken - go to winner
          showScreen('winner');
        } else {
          // Still tied - update display
          updateTiebreaker();
        }
      }, 500);
    }

    function restart() {
      confettiRunning = false;
      $('confettiContainer').innerHTML = '';
      teams.forEach(t => t.score = 0);
      questionStates.forEach(s => {
        s.answered = false;
        s.skipped = false;
        s.teamId = null;
        s.correct = null;
        s.optionsUsed = false;
        s.points = 0;
      });
      currentQ = 0;
      optionsShown = false;
      optionsUsed = false;
      selectedTeamId = null;
      confettiShown = false;
      currentTeamIndex = 0;
      questionRevealed = false;
      $('qTotal').textContent = '/ ' + questions.length;
      showScreen('intro');
    }
  </script>
</body>
</html>
